import{E as I,b as w,F as x,c as _,P as l,J as u,d as a,e as A,f as B,a as m,T as J,M as j,Q as z,I as H,g as q,V as R,h as F,S as G,i as N,j as W,k as U,l as y,m as Z,C as g,n as Q}from"./widgets-B8S9eOpZ.js";import{_ as Y,l as $,x as K,c as X,o as ee}from"./index-a9cQj7t6.js";window.CESIUM_BASE_URL="cesium/";const te=w.WHITE,oe=.25,ie=1;function f(e){e=e??x.EMPTY_OBJECT,this._definitionChanged=new I,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(f.prototype,{isConstant:{get:function(){return l.isConstant(this._color)&&l.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:_("color"),glowPower:_("glowPower"),taperPower:_("taperPower")});f.prototype.getType=function(e){return"PolylineGlow"};const ne=new u;f.prototype.getValue=function(e,t){return a(e)||(e=u.now(ne)),a(t)||(t={}),t.color=l.getValueOrClonedDefault(this._color,e,te,t.color),t.glowPower=l.getValueOrDefault(this._glowPower,e,oe,t.glowPower),t.taperPower=l.getValueOrDefault(this._taperPower,e,ie,t.taperPower),t};f.prototype.equals=function(e){return this===e||e instanceof f&&l.equals(this._color,e._color)&&l.equals(this._glowPower,e._glowPower)&&l.equals(this._taperPower,e._taperPower)};function P(e,t){this._velocityVectorProperty=new A(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new I,this.ellipsoid=t??B.default;const p=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){p._definitionChanged.raiseEvent(p)})}Object.defineProperties(P.prototype,{isConstant:{get:function(){return l.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});const C=new m,re=new m,E=new j,se=new u;P.prototype.getValue=function(e,t){a(e)||(e=u.now(se));const p=this._velocityVectorProperty._getValue(e,re,C);if(a(p))return J.rotationMatrixFromPositionVelocity(C,p,this._ellipsoid,E),z.fromRotationMatrix(E,t)};P.prototype.equals=function(e){return this===e||e instanceof P&&l.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};const ce={id:"cesiumContainer"},ae={__name:"Cesium3d",setup(e){let t=null;async function p(){return await q({requestWaterMask:!0,requestVertexNormals:!0})}function T(o){return window.Cesium?new R("cesiumContainer",{terrainProvider:o,animation:!0,baseLayerPicker:!1,fullscreenButton:!1,sceneModePicker:!1,timeline:!0,navigationHelpButton:!1}):(console.error("Cesium is not loaded"),null)}function k(o=116.39,c=39.9,n=100,r=.01){const i=[];for(let s=0;s<=360;s+=90){const d=m.fromDegrees(o+Math.cos(s*Math.PI/180)*r,c+Math.sin(s*Math.PI/180)*r,n);i.push(d)}return i.push(i[0]),i}function V(o=360,c=10){const n=u.fromDate(new Date),r=u.addSeconds(n,o,new u);return t.clock.startTime=n.clone(),t.clock.stopTime=r.clone(),t.clock.currentTime=n.clone(),t.clock.clockRange=F.LOOP_STOP,t.clock.multiplier=c,{start:n,stop:r}}function S(o,c,n=90){const r=new G;return o.forEach((i,s)=>{const d=u.addSeconds(c,s*n,new u);r.addSample(d,i)}),r}function M(o){const c=w.WHITE;let n=null;o.screenSpaceEventHandler.setInputAction(r=>{const i=o.scene.pick(r.endPosition);n&&(n.model.color=c,n=null),a(i)&&a(i.id)&&(n=i.id,n.model.color=w.YELLOW.withAlpha(.8))},y.MOUSE_MOVE),o.screenSpaceEventHandler.setInputAction(r=>{const i=o.scene.pick(r.position);if(console.log(i),a(i)&&a(i.id)){const s=i.id;if(console.log(s.properties.id._value),s.name){const d=o.scene.pickPosition(r.position);if(a(d)){const h=Z.fromCartesian(d),b=g.toDegrees(h.longitude),v=g.toDegrees(h.latitude),L=h.height,D=`
                        <table class="cesium-infoBox-defaultTable">
                            <tr><th>名称</th><td>${s.name}</td></tr>
                            <tr><th>经度</th><td>${b.toFixed(6)}°</td></tr>
                            <tr><th>纬度</th><td>${v.toFixed(6)}°</td></tr>
                            <tr><th>高度</th><td>${L.toFixed(2)}米</td></tr>
                        </table>
                    `;s.description=D,o.selectedEntity=s}}}else o.selectedEntity=void 0},y.LEFT_CLICK),o.screenSpaceEventHandler.setInputAction(r=>{const i=o.scene.pick(r.position);a(i)&&a(i.id)&&(o.clock.shouldAnimate?o.clock.shouldAnimate=!1:o.clock.shouldAnimate=!0)},y.RIGHT_CLICK)}function O(o,c,n){return t.entities.add({name:"动画模型",availability:new W([new U({start:n.start,stop:n.stop})]),position:c,orientation:new P(c),properties:{id:"自定义id",type:"column"},model:{uri:o,minimumPixelSize:128,maximumScale:2e4,color:w.WHITE,colorBlendMode:N.HIGHLIGHT},path:{resolution:1,material:new f({glowPower:.1,color:w.YELLOW}),width:10}})}return $(async()=>{Q.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJkMDc2Zjk4Mi0zNzE2LTQ1N2ItYmJiZi03MDBjNzE0OTRlN2UiLCJpZCI6MjI2NTIzLCJpYXQiOjE3NDQwODEyNzh9.ZB7sD_ip91ZAppy29yef0-8JFjpSPmtT3chRIZ44Gak";try{await new Promise(d=>{if(window.Cesium)d();else{const h=setInterval(()=>{window.Cesium&&(clearInterval(h),d())},100)}});const o=await p();if(t=T(o),!t)throw new Error("Failed to initialize viewer");const c=await H.fromAssetId(2648381),n=k(),r=V(),i=S(n,r.start),s=O(c,i,r);M(t),t.zoomTo(s),t.scene.globe.enableLighting=!0,t.scene.globe.depthTestAgainstTerrain=!0}catch(o){console.error("Error initializing scene:",o)}}),K(()=>{t&&(t.destroy(),t=null)}),(o,c)=>(ee(),X("div",ce))}},ue=Y(ae,[["__scopeId","data-v-75508a02"]]);export{ue as default};
